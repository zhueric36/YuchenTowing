<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8" />
  <title>Google Sheet 表單示範</title>
  <script type="text/javascript" src="js/API.js"></script>
</head>
<body>
  <h2>送資料到 Google Sheet</h2>
  <label>姓名：<input type="text" id="name" /></label><br /><br />
  <label>Email：<input type="email" id="email" /></label><br /><br />
  <button onclick="sendData()">送出</button>
  <button onclick="loadData()">載入資料</button>

  <h3>現有資料</h3>
  <table border="1" id="dataTable">
    <thead>
      <tr>
        <th>姓名</th>
        <th>Email</th>
        <th>時間</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <!-- <script>
    const scriptURL = "https://script.google.com/macros/s/AKfycbz013uXTv5aqq2TfQlVPqO7VgBvPX3xyHnYoXcfpItrjYSWidOgXO1r7AKIVBqIMSU/exec"; // 替換為你的 Web App 網址

    function sendData() {
      const name = encodeURIComponent(document.getElementById("name").value);
      const email = encodeURIComponent(document.getElementById("email").value);

      fetch(`${scriptURL}?action=write&name=${name}&email=${email}`)
        .then(response => response.text())
        .then(data => {
          alert("送出成功：" + data);
          loadData(); // 插入後重新載入
        })
        .catch(error => alert("錯誤：" + error));
    }

    function loadData() {
      fetch(`${scriptURL}?action=read`)
        .then(response => response.json())
        .then(data => {
          const tbody = document.querySelector("#dataTable tbody");
          tbody.innerHTML = ""; // 清空表格
          data.forEach((row, index) => {
            if (index === 0) return; // 跳過標頭
            const tr = document.createElement("tr");
            tr.innerHTML = `<td>${row[0]}</td><td>${row[1]}</td><td>${row[2]}</td>`;
            tbody.appendChild(tr);
          });
        })
        .catch(error => console.error("載入資料錯誤：", error));
    }

    // 頁面載入時讀取資料
    window.onload = loadData;
  </script> -->
</body>
</html>


